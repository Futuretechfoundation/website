<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VR Course Sample</title>
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    #instructions {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      padding: 5px 10px;
      font-family: Arial, sans-serif;
      z-index: 100;
      border-radius: 5px;
      max-width: 300px;
    }
    #device-type {
      position: absolute;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      padding: 5px 10px;
      font-family: Arial, sans-serif;
      z-index: 100;
      border-radius: 5px;
    }
    #enter-vr-button {
      position: absolute;
      bottom: 10px;
      left: 10px;
      z-index: 100;
      padding: 10px 15px;
      background: #4CC3D9;
      color: white;
      border: none;
      border-radius: 5px;
      font-family: Arial, sans-serif;
      cursor: pointer;
      display: none;
    }
  </style>
</head>
<body>
  <!-- Instructions -->
  <div id="instructions">
    <h3>Welcome to the VR Course</h3>
    <p>Desktop: Use WASD to move and mouse to look around.</p>
    <p>Mobile: Tilt device to look around and tap and hold to move forward.</p>
    <p>VR: If you have a VR headset, click the VR button in the bottom right.</p>
  </div>
  
  <div id="device-type"></div>
  <button id="enter-vr-button">Enter VR Mode</button>

  <!-- VR Scene -->
  <a-scene loading-screen="dotsColor: #4CC3D9; backgroundColor: #ECECEC">
    <!-- Assets -->
    <a-assets>
      <img id="ground-texture" src="/api/placeholder/400/400" alt="ground texture" />
    </a-assets>

    <!-- Environment Background -->
    <a-sky color="#87CEEB"></a-sky>
    
    <!-- Ground -->
    <a-plane 
      position="0 0 0" 
      rotation="-90 0 0" 
      width="30" 
      height="30" 
      color="#7BC8A4" 
      src="#ground-texture" 
      repeat="10 10">
    </a-plane>

    <!-- Rotating Box as Interactive Element -->
    <a-box 
      position="0 1 -3" 
      rotation="0 45 45" 
      color="#4CC3D9"
      animation="property: rotation; to: 0 405 45; loop: true; dur: 4000"
      scale="1 1 1"
      class="clickable">
    </a-box>

    <!-- Additional scene elements -->
    <a-sphere position="-2 1.25 -5" radius="1.25" color="#EF2D5E" class="clickable"></a-sphere>
    <a-cylinder position="2 1.5 -5" radius="0.5" height="3" color="#FFC65D" class="clickable"></a-cylinder>

    <!-- Sample Text -->
    <a-text 
      value="Welcome to the VR Course"
      position="-1.5 2.5 -2"
      scale="1.5 1.5 1.5"
      color="#333333">
    </a-text>

    <!-- Camera and controls -->
    <a-entity id="rig" position="0 1.6 0">
      <a-entity 
        id="camera" 
        camera 
        look-controls="pointerLockEnabled: true"
        wasd-controls="acceleration: 20">
        <a-entity 
          cursor="fuse: false; rayOrigin: mouse;" 
          raycaster="objects: .clickable; far: 20;"
          position="0 0 -0.1"
          geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
          material="color: white; opacity: 0.5; shader: flat">
        </a-entity>
      </a-entity>
    </a-entity>
  </a-scene>

  <script>
    // Device detection
    function detectDevice() {
      const deviceTypeEl = document.getElementById('device-type');
      const enterVRButton = document.getElementById('enter-vr-button');
      
      // Check if device is mobile
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      
      // Check VR capability
      const hasVR = 'xr' in navigator;
      
      if (isMobile) {
        deviceTypeEl.textContent = "Mobile Device Detected";
        // Adjust controls for mobile
        const camera = document.getElementById('camera');
        camera.setAttribute('look-controls', 'pointerLockEnabled: false');
        
        // Add touch movement
        document.addEventListener('touchstart', function() {
          const rig = document.getElementById('rig');
          rig.setAttribute('movement-controls', 'speed: 0.1');
        });
      } else {
        deviceTypeEl.textContent = "Desktop Device Detected";
      }
      
      // Handle VR availability
      if (hasVR) {
        enterVRButton.style.display = 'block';
        enterVRButton.addEventListener('click', function() {
          const scene = document.querySelector('a-scene');
          if (scene.is('vr-mode')) {
            scene.exitVR();
          } else {
            scene.enterVR();
          }
        });
      }
    }

    // Make elements interactive
    function setupInteractions() {
      const clickableElements = document.querySelectorAll('.clickable');
      
      clickableElements.forEach(element => {
        element.addEventListener('mouseenter', function() {
          element.setAttribute('scale', '1.2 1.2 1.2');
        });
        
        element.addEventListener('mouseleave', function() {
          element.setAttribute('scale', '1 1 1');
        });
        
        element.addEventListener('click', function() {
          // Change color on click
          const currentColor = element.getAttribute('color');
          const newColor = currentColor === '#4CC3D9' ? '#FF6B6B' : '#4CC3D9';
          element.setAttribute('color', newColor);
          
          // Add a small animation on click
          element.setAttribute('animation__click', {
            property: 'position',
            to: `${element.getAttribute('position').x} ${parseFloat(element.getAttribute('position').y) + 0.2} ${element.getAttribute('position').z}`,
            dur: 150,
            dir: 'alternate',
            easing: 'easeInOutQuad',
            loop: 2
          });
        });
      });
    }

    // Run after scene loads
    document.querySelector('a-scene').addEventListener('loaded', function () {
      detectDevice();
      setupInteractions();
      
      // Hide loading instructions after a delay
      setTimeout(function() {
        const instructions = document.getElementById('instructions');
        instructions.style.opacity = '0.7';
      }, 5000);
    });
  </script>
</body>
  </html>
